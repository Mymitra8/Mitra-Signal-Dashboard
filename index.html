async function makeRequest(action, data = {}) {
    if (!gasUrl) {
        showNotification('No connection URL configured', 'error');
        return null;
    }

    const requestData = { action, ...data };

    try {
        const response = await fetch(gasUrl, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(requestData)
        });

        const text = await response.text();
        let result;
        try {
            result = JSON.parse(text);
        } catch (err) {
            throw new Error('Invalid JSON from server: ' + text);
        }
        return result;

    } catch (error) {
        showNotification('Request failed: ' + (error.message || error), 'error');
        return null;
    }
}
