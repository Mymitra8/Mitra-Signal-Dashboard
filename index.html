<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mitra Signal - Trading Dashboard</title>
    <meta name="theme-color" content="#1a1b23">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2300d4aa'%3E%3Cpath d='M12 2l8 3.738v7.524l-8 3.738-8-3.738V5.738L12 2z'/%3E%3C/svg%3E">
    
    <style>
        :root {
            --bg-primary: #0a0b0f;
            --bg-secondary: #1a1b23;
            --bg-card: #252730;
            --bg-hover: #2a2d3a;
            --text-primary: #ffffff;
            --text-secondary: #a1a8b7;
            --text-muted: #6b7280;
            --accent-primary: #00d4aa;
            --accent-secondary: #0ea5e9;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --border: #374151;
            --shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-success: linear-gradient(135deg, #10b981 0%, #059669 100%);
            --gradient-warning: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            --gradient-error: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 24px;
            position: sticky;
            top: 20px;
            z-index: 100;
            backdrop-filter: blur(20px);
            box-shadow: var(--shadow);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-primary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
            color: white;
        }

        .logo-text {
            font-size: 24px;
            font-weight: 700;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 50px;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .status-running {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .status-stopped {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .pulse {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        /* Setup Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            padding: 20px;
        }

        .modal-content {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 32px;
            max-width: 500px;
            width: 100%;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 16px;
            text-align: center;
        }

        .modal-description {
            color: var(--text-secondary);
            margin-bottom: 24px;
            text-align: center;
            line-height: 1.6;
        }

        .form-input {
            width: 100%;
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            color: var(--text-primary);
            font-size: 16px;
            margin-bottom: 16px;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(0, 212, 170, 0.1);
        }

        .form-input::placeholder {
            color: var(--text-muted);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gradient-primary);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow);
            border-color: var(--accent-primary);
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .stat-title {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .stat-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-description {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Control Panel */
        .control-panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 32px;
            margin-bottom: 32px;
        }

        .control-header {
            margin-bottom: 32px;
        }

        .control-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .control-subtitle {
            color: var(--text-secondary);
            font-size: 16px;
        }

        .control-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 32px;
        }

        .control-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .form-select {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 12px 16px;
            color: var(--text-primary);
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(0, 212, 170, 0.1);
        }

        .btn {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 16px 24px;
            color: var(--text-primary);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: var(--gradient-success);
            border-color: var(--success);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }

        .btn-danger {
            background: var(--gradient-error);
            border-color: var(--error);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.3);
        }

        .btn-secondary {
            background: var(--gradient-primary);
            border-color: var(--accent-secondary);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(14, 165, 233, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        /* Loading States */
        .loading {
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid transparent;
            border-top: 2px solid currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .empty-state {
            text-align: center;
            padding: 64px 32px;
            color: var(--text-muted);
        }

        .empty-icon {
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .container {
                padding: 16px;
            }

            .header {
                padding: 20px;
                border-radius: 16px;
                top: 16px;
            }

            .header-content {
                flex-direction: column;
                text-align: center;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .stat-card {
                padding: 20px;
            }

            .control-panel {
                padding: 24px;
                border-radius: 16px;
            }

            .control-grid {
                grid-template-columns: 1fr;
                gap: 24px;
            }

            .modal-content {
                padding: 24px;
                margin: 20px;
            }
        }

        @media (max-width: 480px) {
            .logo-text {
                font-size: 20px;
            }

            .stat-value {
                font-size: 24px;
            }

            .control-title {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Setup Modal -->
    <div class="modal" id="setupModal">
        <div class="modal-content">
            <h2 class="modal-title">üöÄ Welcome to Mitra Signal</h2>
            <p class="modal-description">
                To get started, please enter your Google Apps Script Web App URL. 
                This connects your dashboard to the trading bot backend.
            </p>
            <input type="url" 
                   class="form-input" 
                   id="gasUrlInput" 
                   placeholder="https://script.google.com/macros/s/AKfycbyQH44mIHTuI2IDAi0gmvpQHlnk1h47EV7xE8WK1TVRF0SnuapxL0TPrwjIIThMWhPg/exec"
                   value="">
            <div style="display: flex; gap: 12px; margin-top: 16px;">
                <button class="btn btn-primary" onclick="saveGasUrl()" style="flex: 1;">
                    Connect
                </button>
                <button class="btn" onclick="showHelp()" style="flex: 1;">
                    Help
                </button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">M</div>
                    <div class="logo-text">Mitra Signal</div>
                </div>
                <div class="status-indicator" id="statusIndicator">
                    <div class="pulse" id="statusPulse"></div>
                    <span id="statusText">Connecting...</span>
                </div>
            </div>
        </header>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-title">Active Strategy</span>
                    <div class="stat-icon" style="background: var(--gradient-primary);">üìà</div>
                </div>
                <div class="stat-value" id="activeStrategy">Enhanced</div>
                <div class="stat-description">Current trading strategy</div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-title">Today's Alerts</span>
                    <div class="stat-icon" style="background: var(--gradient-success);">üö®</div>
                </div>
                <div class="stat-value" id="todayAlerts">0</div>
                <div class="stat-description">Signals sent today</div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-title">Alert Limit</span>
                    <div class="stat-icon" style="background: var(--gradient-warning);">‚ö°</div>
                </div>
                <div class="stat-value" id="alertLimit">5</div>
                <div class="stat-description">Daily maximum alerts</div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-title">Last Update</span>
                    <div class="stat-icon" style="background: var(--gradient-primary);">üïí</div>
                </div>
                <div class="stat-value" id="lastUpdate" style="font-size: 18px;">Never</div>
                <div class="stat-description">Engine last activity</div>
            </div>
        </div>

        <!-- Control Panel -->
        <div class="control-panel">
            <div class="control-header">
                <h2 class="control-title">Engine Control</h2>
                <p class="control-subtitle">Manage your trading bot and strategy settings</p>
            </div>
            <div class="control-grid">
                <div class="control-section">
                    <div class="form-group">
                        <label class="form-label">Trading Strategy</label>
                        <select class="form-select" id="strategySelect">
                            <option value="Enhanced">Enhanced Multi-Strategy</option>
                            <option value="Ganu">Ganu Strategy (Conservative)</option>
                            <option value="Scalping">Quick Scalp (Aggressive)</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" id="startBtn">
                        <span>üöÄ</span> Start Engine
                    </button>
                    <button class="btn btn-danger" id="stopBtn" disabled>
                        <span>‚èπÔ∏è</span> Stop Engine
                    </button>
                </div>

                <div class="control-section">
                    <button class="btn btn-secondary" id="manualScanBtn">
                        <span>üîç</span> Run Manual Scan
                    </button>
                    <button class="btn" id="testConnectionBtn">
                        <span>üß™</span> Test Connection
                    </button>
                    <a href="https://docs.google.com/spreadsheets/d/1_LnY1tsOjftlbBzYpWIew3dMgNhKxpoOsOWFE0Eg_Es/edit" 
                       target="_blank" class="btn">
                        <span>üìä</span> View Sheets
                    </a>
                    <button class="btn" onclick="resetConnection()">
                        <span>‚öôÔ∏è</span> Change URL
                    </button>
                </div>
            </div>
        </div>

        <!-- Recent Activity -->
        <div class="control-panel">
            <div class="control-header">
                <h2 class="control-title">System Status</h2>
                <p class="control-subtitle">Monitor your trading bot performance</p>
            </div>
            <div class="empty-state">
                <div class="empty-icon">üìä</div>
                <p>Dashboard ready! Connect to your Google Apps Script to start monitoring signals.</p>
            </div>
        </div>
    </div>

    <script>
        let gasUrl = '';

        // Show setup modal on first load
        document.addEventListener('DOMContentLoaded', function() {
            const savedUrl = localStorage.getItem('mitraGasUrl');
            if (savedUrl) {
                gasUrl = savedUrl;
                document.getElementById('setupModal').style.display = 'none';
                initializeDashboard();
            } else {
                document.getElementById('setupModal').style.display = 'flex';
            }
        });

        function saveGasUrl() {
            const input = document.getElementById('gasUrlInput');
            const url = input.value.trim();
            
            if (!url) {
                showNotification('Please enter a valid URL', 'error');
                return;
            }

            if (!url.includes('script.google.com')) {
                showNotification('Please enter a valid Google Apps Script URL', 'error');
                return;
            }

            gasUrl = url;
            localStorage.setItem('mitraGasUrl', url);
            document.getElementById('setupModal').style.display = 'none';
            
            showNotification('Connection saved! Testing...', 'success');
            initializeDashboard();
        }

        function showHelp() {
            const helpText = `To get your Google Apps Script URL:

1. Go to script.google.com
2. Create a new project
3. Paste the Google Apps Script code
4. Deploy ‚Üí New Deployment ‚Üí Web App
5. Set access to "Anyone"
6. Copy the URL and paste it here

Need more help? Check the deployment guide!`;

            alert(helpText);
        }

        function resetConnection() {
            localStorage.removeItem('mitraGasUrl');
            gasUrl = '';
            document.getElementById('gasUrlInput').value = '';
            document.getElementById('setupModal').style.display = 'flex';
        }

        function initializeDashboard() {
            updateStatusIndicator('stopped', 'Connecting...');
            testConnection();
            setupEventListeners();
            startPeriodicUpdate();
        }

        function setupEventListeners() {
            document.getElementById('startBtn').addEventListener('click', startEngine);
            document.getElementById('stopBtn').addEventListener('click', stopEngine);
            document.getElementById('manualScanBtn').addEventListener('click', runManualScan);
            document.getElementById('testConnectionBtn').addEventListener('click', testConnection);
        }

        async function makeRequest(action, data = {}) {
            if (!gasUrl) {
                showNotification('No connection URL configured', 'error');
                return null;
            }

            try {
                const payload = { action, ...data };
                const response = await fetch(gasUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload),
                    mode: 'cors'
                });

                const result = await response.json();
                return result;
            } catch (error) {
                console.error('Request failed:', error);
                updateStatusIndicator('stopped', 'Connection Error');
                return null;
            }
        }

        async function testConnection() {
            const btn = document.getElementById('testConnectionBtn');
            btn.innerHTML = '<div class="loading"><div class="spinner"></div> Testing...</div>';
            btn.disabled = true;

            try {
                const response = await fetch(gasUrl);
                const result = await response.json();
                
                if (result.success || result.data) {
                    updateStatusIndicator('stopped', 'Connected');
                    showNotification('Connection successful!', 'success');
                    if (result.data) {
                        updateDashboard(result.data);
                    }
                } else {
                    throw new Error('Invalid response');
                }
            } catch (error) {
                updateStatusIndicator('stopped', 'Connection Failed');
                showNotification('Connection failed. Check your URL.', 'error');
            }

            btn.innerHTML = '<span>üß™</span> Test Connection';
            btn.disabled = false;
        }

        async function startEngine() {
            const strategy = document.getElementById('strategySelect').value;
            const btn = document.getElementById('startBtn');
            
            btn.innerHTML = '<div class="loading"><div class="spinner"></div> Starting...</div>';
            btn.disabled = true;

            const result = await makeRequest('start', { strategy });
            
            if (result && result.success) {
                showNotification('Engine started successfully!', 'success');
                updateStatus();
            } else {
                showNotification('Failed to start engine', 'error');
                btn.innerHTML = '<span>üöÄ</span> Start Engine';
                btn.disabled = false;
            }
        }

        async function stopEngine() {
            const btn = document.getElementById('stopBtn');
            
            btn.innerHTML = '<div class="loading"><div class="spinner"></div> Stopping...</div>';
            btn.disabled = true;

            const result = await makeRequest('stop');
            
            if (result && result.success) {
                showNotification('Engine stopped successfully!', 'success');
                updateStatus();
            } else {
                showNotification('Failed to stop engine', 'error');
                btn.innerHTML = '<span>‚èπÔ∏è</span> Stop Engine';
                btn.disabled = false;
            }
        }

        async function runManualScan() {
            const strategy = document.getElementById('strategySelect').value;
            const btn = document.getElementById('manualScanBtn');
            
            btn.innerHTML = '<div class="loading"><div class="spinner"></div> Scanning...</div>';
            btn.disabled = true;

            const result = await makeRequest('manualScan', { strategy });
            
            if (result && result.success) {
                showNotification('Manual scan completed!', 'success');
            } else {
                showNotification('Manual scan failed', 'error');
            }

            btn.innerHTML = '<span>üîç</span> Run Manual Scan';
            btn.disabled = false;
        }

        async function updateStatus() {
            if (!gasUrl) return;

            try {
                const response = await fetch(gasUrl);
                const result = await response.json();
                
                if (result.success && result.data) {
                    updateDashboard(result.data);
                }
            } catch (error) {
                console.error('Status update failed:', error);
            }
        }

        function updateDashboard(status) {
            // Update status indicator
            updateStatusIndicator(
                status.isRunning ? 'running' : 'stopped',
                status.isRunning ? 'Running' : 'Connected'
            );

            // Update stats
            document.getElementById('activeStrategy').textContent = status.activeStrategy || 'Enhanced';
            document.getElementById('todayAlerts').textContent = status.dailyAlerts || '0';
            document.getElementById('alertLimit').textContent = status.maxDailyAlerts || '5';
            
            // Update last update time
            if (status.lastUpdate) {
                const date = new Date(status.lastUpdate);
                document.getElementById('lastUpdate').textContent = date.toLocaleTimeString();
            }

            // Update controls
            const startBtn = document.getElementById('startBtn');
            const stopBtn = document.getElementById('stopBtn');
            const strategySelect = document.getElementById('strategySelect');

            if (status.isRunning) {
                startBtn.disabled = true;
                startBtn.innerHTML = '<span>üöÄ</span> Engine Running';
                stopBtn.disabled = false;
                stopBtn.innerHTML = '<span>‚èπÔ∏è</span> Stop Engine';
                strategySelect.disabled = true;
            } else {
                startBtn.disabled = false;
                startBtn.innerHTML = '<span>üöÄ</span> Start Engine';
                stopBtn.disabled = true;
                stopBtn.innerHTML = '<span>‚èπÔ∏è</span> Stopped';
                strategySelect.disabled = false;
            }

            strategySelect.value = status.activeStrategy || 'Enhanced';
        }

        function updateStatusIndicator(status, text) {
            const indicator = document.getElementById('statusIndicator');
            const pulse = document.getElementById('statusPulse');
            const statusText = document.getElementById('statusText');

            indicator.className = `status-indicator status-${status}`;
            pulse.style.backgroundColor = status === 'running' ? 'var(--success)' : 'var(--error)';
            statusText.textContent = text;
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 10000;
                padding: 16px 24px;
                border-radius: 12px;
                color: white;
                font-weight: 600;
                max-width: 300px;
                transform: translateX(100%);
                transition: transform 0.3s ease;
                background: ${type === 'success' ? 'var(--gradient-success)' : 
                           type === 'error' ? 'var(--gradient-error)' : 'var(--gradient-primary)'};
                box-shadow: var(--shadow);
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        function startPeriodicUpdate() {
            setInterval(() => {
                if (gasUrl) {
                    updateStatus();
                }
            }, 30000); // Update every 30 seconds
        }

        // PWA Installation prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            const installButton = document.createElement('button');
            installButton.className = 'btn btn-secondary';
            installButton.innerHTML = '<span>üì±</span> Install App';
            installButton.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                z-index: 1000;
                box-shadow: var(--shadow);
            `;
            
            installButton.addEventListener('click', async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    deferredPrompt = null;
                    document.body.removeChild(installButton);
                    
                    if (outcome === 'accepted') {
                        showNotification('App installed successfully!', 'success');
                    }
                }
            });
            
            document.body.appendChild(installButton);
            
            // Auto-remove after 10 seconds
            setTimeout(() => {
                if (document.body.contains(installButton)) {
                    installButton.style.opacity = '0';
                    setTimeout(() => {
                        if (document.body.contains(installButton)) {
                            document.body.removeChild(installButton);
                        }
                    }, 300);
                }
            }, 10000);
        });
    </script>
</body>
</html>